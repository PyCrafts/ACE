FROM ubuntu:18.04
ARG DEBIAN_FRONTEND=noninteractive
ENV SAQ_HOME /opt/ace
ENV SAQ_USER ace
ENV SAQ_GROUP ace
ENV TERM xterm
ENV TZ UTC
RUN groupadd $SAQ_GROUP
RUN useradd -g $SAQ_GROUP -m -s /bin/bash -p ${ACE_PASSWORD:-password} $SAQ_USER 
COPY --chown=ace:ace installer/common.sh /opt/ace/installer/common.sh
COPY --chown=ace:ace docker/provision/ace/install_ubuntu_packages.sh /opt/ace/docker/provision/ace/install_ubuntu_packages.sh
WORKDIR /opt/ace
RUN docker/provision/ace/install_ubuntu_packages.sh
COPY --chown=ace:ace installer/install_python_packages.sh /opt/ace/installer/install_python_packages.sh
COPY --chown=ace:ace installer/requirements-3.6.txt /opt/ace/installer/requirements-3.6.txt
COPY --chown=ace:ace installer/requirements-2.7.txt /opt/ace/installer/requirements-2.7.txt
RUN installer/install_python_packages.sh
COPY --chown=ace:ace . /opt/ace
RUN mkdir /opt/signatures 
RUN chown ace:ace /opt/signatures
USER ace
RUN docker/provision/ace/install
